<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Model selection • fHMM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model selection">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fHMM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/fHMM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/v01_model_definition.html">Model definition</a></li>
    <li><a class="dropdown-item" href="../articles/v02_controls.html">Controls</a></li>
    <li><a class="dropdown-item" href="../articles/v03_data_management.html">Data management</a></li>
    <li><a class="dropdown-item" href="../articles/v04_model_estimation.html">Model estimation</a></li>
    <li><a class="dropdown-item" href="../articles/v05_state_decoding_and_prediction.html">State decoding and prediction</a></li>
    <li><a class="dropdown-item" href="../articles/v06_model_checking.html">Model checking</a></li>
    <li><a class="dropdown-item" href="../articles/v07_model_selection.html">Model selection</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/loelschlaeger/fHMM/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Model selection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/loelschlaeger/fHMM/blob/master/vignettes/v07_model_selection.Rmd" class="external-link"><code>vignettes/v07_model_selection.Rmd</code></a></small>
      <div class="d-none name"><code>v07_model_selection.Rmd</code></div>
    </div>

    
    
<p>Model selection involves the choice of a family for the
state-dependent distribution and the selection of the number of states.
This vignette<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;This vignette was build using R 4.4.1 with the
&lt;a href="https://loelschlaeger.de/fHMM/"&gt;fHMM&lt;/a&gt; 1.4.1 package.&lt;/p&gt;'><sup>1</sup></a> introduces model selection in
<a href="https://loelschlaeger.de/fHMM/">fHMM</a>.</p>
<div class="section level2">
<h2 id="information-criteria">Information criteria<a class="anchor" aria-label="anchor" href="#information-criteria"></a>
</h2>
<p>Common model selection tools are information criteria, such as the
Akaike information criterion (AIC) or the Bayesian information criterion
(BIC), both of which aim at finding a compromise between model fit and
model complexity.</p>
<p>The AIC is defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">AIC</mtext><mo>=</mo><mo>−</mo><mn>2</mn><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ℒ</mi><mtext mathvariant="normal">(H)HMM</mtext></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>θ</mi><mrow><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>i</mi></msub><mo>∣</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub><mo>,</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mrow><mi>t</mi><mo>,</mo><msup><mi>t</mi><mo>*</mo></msup></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>t</mi><mo>*</mo></msup></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mn>2</mn><mi>p</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{AIC} = - 2 \log (\mathcal{L}^\text{(H)HMM}(\theta,(\theta^{*(i)})_i\mid (X_t)_t,((X^*_{t,t^*})_{t^*})_t)) + 2 p,
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>p</mi><annotation encoding="application/x-tex">p</annotation></semantics></math>
denotes the number of parameters, while the BIC is defined as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mtext mathvariant="normal">BIC</mtext><mo>=</mo><mo>−</mo><mn>2</mn><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>ℒ</mi><mtext mathvariant="normal">(H)HMM</mtext></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo>,</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>θ</mi><mrow><mo>*</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>i</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>i</mi></msub><mo>∣</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>X</mi><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub><mo>,</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>X</mi><mrow><mi>t</mi><mo>,</mo><msup><mi>t</mi><mo>*</mo></msup></mrow><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>t</mi><mo>*</mo></msup></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>t</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>p</mi><mo>,</mo></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align*}
\text{BIC} = - 2 \log (\mathcal{L}^\text{(H)HMM}(\theta,(\theta^{*(i)})_i\mid (X_t)_t,((X^*_{t,t^*})_{t^*})_t)) + \log(T) p,
\end{align*}</annotation></semantics></math> where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>T</mi><annotation encoding="application/x-tex">T</annotation></semantics></math>
is the total number of observations.</p>
</div>
<div class="section level2">
<h2 id="challenges-associated-with-model-selection">Challenges associated with model selection<a class="anchor" aria-label="anchor" href="#challenges-associated-with-model-selection"></a>
</h2>
<p>In practice, however, information criteria often favor overly complex
models. Real data typically exhibit more structure than can actually be
captured by the model. This can be the case if the true state-dependent
distributions are too complex to be fully modeled by some (rather
simple) parametric distribution, or if certain temporal patterns are
neglected in the model formulation. Additional states may be able to
capture this structure, which can lead to an increased goodness of fit
that outweighs the higher model complexity. However, as models with too
many states are difficult to interpret and are therefore often not
desired, information criteria should be treaten with some caution and
only considered as a rough guidance. For an in-depth discussion of
pitfalls, practical challenges, and pragmatic solutions regarding model
selection, see <span class="citation">Pohle et al. (<a href="#ref-poh17">2017</a>)</span>.</p>
</div>
<div class="section level2">
<h2 id="the-compare_models-function">The <code>compare_models()</code> function<a class="anchor" aria-label="anchor" href="#the-compare_models-function"></a>
</h2>
<p>The <a href="https://loelschlaeger.de/fHMM/">fHMM</a> package provides a convenient tool for
comparing different models via the <code><a href="../reference/compare_models.html">compare_models()</a></code>
function. The models (arbitrarily many) can be directly passed to the
<code><a href="../reference/compare_models.html">compare_models()</a></code> function that returns an overview of the
above model selection criteria. Below, we compare a 2-state HMM with
normal state-dependent distributions with a 3-state HMM with
state-dependent t-distributions for the DAX data, where the more complex
model is clearly preferred:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dax_model_2n</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dax_model_3t</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/compare_models.html">compare_models</a></span><span class="op">(</span><span class="va">dax_model_2n</span>, <span class="va">dax_model_3t</span><span class="op">)</span></span>
<span><span class="co">#&gt;              parameters loglikelihood       AIC       BIC</span></span>
<span><span class="co">#&gt; dax_model_2n          6      17403.61 -34795.21 -34755.13</span></span>
<span><span class="co">#&gt; dax_model_3t         15      17650.02 -35270.05 -35169.85</span></span></code></pre></div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-poh17" class="csl-entry">
Pohle, J., R. Langrock, F. M. van Beest, and N. M. Schmidt. 2017.
<span>“Selecting the Number of States in Hidden Markov Models: Pragmatic
Solutions Illustrated Using Animal Movement.”</span> <em>Journal of
Agricultural, Biological and Environmental Statistics</em> 22 (3):
270–93.
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>, <a href="https://www.uni-bielefeld.de/fakultaeten/wirtschaftswissenschaften/lehrbereiche/statisticalmodelling/" class="external-link">Timo Adam</a>, <a href="https://ekvv.uni-bielefeld.de/pers_publ/publ/PersonDetail.jsp?personId=241029889" class="external-link">Rouven Michels</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
