<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fHMM">
<title>Model definition • fHMM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model definition">
<meta property="og:description" content="fHMM">
<meta property="og:image" content="https://loelschlaeger.github.io/fHMM/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fHMM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/fHMM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v01_model_definition.html">Model definition</a>
    <a class="dropdown-item" href="../articles/v02_controls.html">Controls</a>
    <a class="dropdown-item" href="../articles/v03_data_management.html">Data management</a>
    <a class="dropdown-item" href="../articles/v04_model_estimation.html">Model estimation</a>
    <a class="dropdown-item" href="../articles/v05_state_decoding_and_prediction.html">State decoding and prediction</a>
    <a class="dropdown-item" href="../articles/v06_model_checking.html">Model checking</a>
    <a class="dropdown-item" href="../articles/v07_model_selection.html">Model selection</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/loelschlaeger/fHMM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="v01_model_definition_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Model definition</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/loelschlaeger/fHMM/blob/HEAD/vignettes/v01_model_definition.Rmd" class="external-link"><code>vignettes/v01_model_definition.Rmd</code></a></small>
      <div class="d-none name"><code>v01_model_definition.Rmd</code></div>
    </div>

    
    
<!-- 
Assignee: Rouven
Purpose: definition of HMMs, definition of hierarchical structure
-->
<p>The {fHMM} package is an implementation of the hidden Markov model with a focus on applications to financial time series data. This vignette<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;This vignette was build using R 4.2.0 with the {fHMM} 1.0.1.9000 package.&lt;/p&gt;"><sup>1</sup></a> introduces the model and its hierarchical extension. It closely follows <span class="citation">Oelschläger and Adam (<a href="#ref-oel21" role="doc-biblioref">2021</a>)</span>.</p>
<div class="section level2">
<h2 id="the-hidden-markov-model">The Hidden Markov Model<a class="anchor" aria-label="anchor" href="#the-hidden-markov-model"></a>
</h2>
<p>Hidden Markov models (HMMs) are a modeling framework for time series data where a sequence of observation is assumed to depend on a latent state process. The peculiarity is that, instead of the observation process, the state process cannot be directly observed. However, the latent states comprise information about the environment the model is applied on.</p>
<p>The connection between hidden state process and observed state-dependent process arises by the following: Let <span class="math inline">\(N\)</span> be the number of possible states. We assume that for each point in time <span class="math inline">\(t = 1, \ldots, T\)</span>, an underlying process <span class="math inline">\((S_t)_{t = 1, \ldots, T}\)</span> selects one of those <span class="math inline">\(N\)</span> states. Then, depending on the active state <span class="math inline">\(S_t \in \{ 1, \ldots, N \}\)</span>, the observation <span class="math inline">\(X_t\)</span> from the state-dependent process <span class="math inline">\((X_t)_{t = 1, \ldots, T}\)</span> is generated by one of <span class="math inline">\(N\)</span> distributions <span class="math inline">\(f^{(1)},\dots,f^{(N)}.\)</span><a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;The {fHMM} package includes the normal- and t-distribution for modeling log-returns and the gamma distribution for modeling absolute quantities like trading volume.&lt;/p&gt;"><sup>2</sup></a></p>
<p>Furthermore, we assume <span class="math inline">\((S_t)_t\)</span> to be Markovian, i.e. we assume that the actual state only depends on the previous state. Henceforth, we can identify the process by its initial distribution <span class="math inline">\(\delta\)</span> and its transition probability matrix (t.p.m.) <span class="math inline">\(\Gamma\)</span>. Moreover, by construction, we force the process <span class="math inline">\((X_t)_{t = 1, \ldots, T}\)</span> to satisfy the conditional independence assumption, i.e. the actual observation <span class="math inline">\(X_t\)</span> depends on the current state <span class="math inline">\(S_t\)</span>, but does not depend on previous observations or states at all. The following graphic visualizes the dependence structure:</p>
<div class="figure">
<img src="hmm.png" style="width:80.0%" alt=""><p class="caption">Dependence structure of the HMM.</p>
</div>
<p>Referring to financial data, the different states can serve as proxies for the actual market situation, e.g. calm or nervous. Even though these moods cannot be observed directly, price changes or trading volumes, which clearly depend on the current mood of the market, can be observed. Thereby, using an underlying Markov process, we can detect which mood is active at any point in time and how the different moods alternate. Depending on the current mood, a price change is generated by a different distribution. These distributions characterize the moods in terms of expected return and volatility.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;For example, we can model price changes at time point &lt;span class="math inline"&gt;\(t\)&lt;/span&gt; to be generated by different normal distributions whose mean and volatility depend on &lt;span class="math inline"&gt;\(S_t\)&lt;/span&gt;.&lt;/p&gt;'><sup>3</sup></a></p>
<p>Following <span class="citation">Zucchini, MacDonald, and Langrock (<a href="#ref-zuc16" role="doc-biblioref">2016</a>)</span>, we assume that the initial distribution <span class="math inline">\(\delta\)</span> equals the stationary distribution <span class="math inline">\(\pi\)</span>, where <span class="math inline">\(\pi = \pi \Gamma\)</span>, i.e. the stationary and henceforth the initial distribution is determined by <span class="math inline">\(\Gamma\)</span>.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;If the Markov process is irreducible, it has a unique distribution, which solves &lt;span class="math inline"&gt;\(\pi = \pi \Gamma\)&lt;/span&gt;. If additionally the Markov process is aperiodic, its state distribution converges to the stationary distribution, see &lt;span class="citation"&gt;Norris (&lt;a href="#ref-nor97" role="doc-biblioref"&gt;1997&lt;/a&gt;)&lt;/span&gt;. Irreducibility and aperiodicity are usually satisfied assumptions in reality.&lt;/p&gt;'><sup>4</sup></a> This is reasonable from a practical point of view: On the one hand, the hidden state process has been evolving for some time before we start to observe it and hence can be assumed to be stationary. On the other hand, setting <span class="math inline">\(\delta=\pi\)</span> reduces the number of parameters that need to be estimated, which is convenient from a computational perspective.</p>
</div>
<div class="section level2">
<h2 id="adding-a-hierarchical-structure">Adding a Hierarchical Structure<a class="anchor" aria-label="anchor" href="#adding-a-hierarchical-structure"></a>
</h2>
<p>The hierarchical hidden Markov model (HMMM) is a flexible extension of the HMM that can jointly model data observed on two different time scales. The two time series, one on a coarser and one on a finer scale, differ in the number of observations, e.g. monthly observations on the coarser scale and daily or weekly observations on the finer scale.</p>
<p>Following the concept of HMMs, we can model both state-dependent time series jointly. First, we treat the time series on the coarser scale as stemming from an ordinary HMM, which we refer to as the coarse-scale HMM: At each time point <span class="math inline">\(t\)</span> of the coarse-scale time space <span class="math inline">\(\{1,\dots,T\}\)</span>, an underlying process <span class="math inline">\((S_t)_t\)</span> selects one state from the coarse-scale state space <span class="math inline">\(\{1,\dots,N\}\)</span>. We call <span class="math inline">\((S_t)_t\)</span> the hidden coarse-scale state process. Depending on which state is active at <span class="math inline">\(t\)</span>, one of <span class="math inline">\(N\)</span> distributions <span class="math inline">\(f^{(1)},\dots,f^{(N)}\)</span> realizes the observation <span class="math inline">\(X_t\)</span>. The process <span class="math inline">\((X_t)_t\)</span> is called the observed coarse-scale state-dependent process. The processes <span class="math inline">\((S_t)_t\)</span> and <span class="math inline">\((X_t)_t\)</span> have the same properties as before, namely <span class="math inline">\((S_t)_t\)</span> is a first-order Markov process and <span class="math inline">\((X_t)_t\)</span> satisfies the conditional independence assumption.</p>
<p>Subsequently, we segment the observations of the fine-scale time series into <span class="math inline">\(T\)</span> distinct chunks, each of which contains all data points that correspond to the <span class="math inline">\(t\)</span>-th coarse-scale time point. Assuming that we have <span class="math inline">\(T^*\)</span> fine-scale observations on every coarse-scale time point, we face <span class="math inline">\(T\)</span> chunks comprising of <span class="math inline">\(T^*\)</span> fine-scale observations each.</p>
<p>The hierarchical structure now evinces itself as we model each of the chunks by one of <span class="math inline">\(N\)</span> possible fine-scale HMMs. Each of the fine-scale HMMs has its own t.p.m. <span class="math inline">\(\Gamma^{*(i)}\)</span>, initial distribution <span class="math inline">\(\delta^{*(i)}\)</span>, stationary distribution <span class="math inline">\(\pi^{*(i)}\)</span>, and state-dependent distributions <span class="math inline">\(f^{*(i,1)},\dots,f^{*(i,N^*)}\)</span>. Which fine-scale HMM is selected to explain the <span class="math inline">\(t\)</span>-th chunk of fine-scale observations depends on the hidden coarse-scale state <span class="math inline">\(S_t\)</span>. The <span class="math inline">\(i\)</span>-th fine-scale HMM explaining the <span class="math inline">\(t\)</span>-th chunk of fine-scale observations consists of the following two stochastic processes: At each time point <span class="math inline">\(t^*\)</span> of the fine-scale time space <span class="math inline">\(\{1,\dots,T^*\}\)</span>, the process <span class="math inline">\((S^*_{t,t^*})_{t^*}\)</span> selects one state from the fine-scale state space <span class="math inline">\(\{1,\dots,N^*\}\)</span>. We call <span class="math inline">\((S^*_{t,t^*})_{t^*}\)</span> the hidden fine-scale state process. Depending on which state is active at <span class="math inline">\(t^*\)</span>, one of <span class="math inline">\(N^*\)</span> distributions <span class="math inline">\(f^{*(i,1)},\dots,f^{*(i,N^*)}\)</span> realizes the observation <span class="math inline">\(X^*_{t,t^*}\)</span>. The process <span class="math inline">\((X^*_{t,t^*})_{t^*}\)</span> is called the observed fine-scale state-dependent process.</p>
<p>The fine-scale processes <span class="math inline">\((S^*_{1,t^*})_{t^*},\dots,(S^*_{T,t^*})_{t^*}\)</span> and <span class="math inline">\((X^*_{1,t^*})_{t^*},\dots,(X^*_{T,t^*})_{t^*}\)</span> satisfy the Markov property and the conditional independence assumption, respectively, as well. Furthermore, it is assumed that the fine-scale HMM explaining <span class="math inline">\((X^*_{t,t^*})_{t^*}\)</span> only depends on <span class="math inline">\(S_t\)</span>. This hierarchical structure is visualized in the following:</p>
<div class="figure">
<img src="hhmm.png" style="width:80.0%" alt=""><p class="caption">Dependence structure of the HHMM.</p>
</div>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-nor97">
<p>Norris, J. R. 1997. “Markov Chains.” <em>Cambridge University Press</em>.</p>
</div>
<div id="ref-oel21">
<p>Oelschläger, L., and T. Adam. 2021. “Detecting Bearish and Bullish Markets in Financial Time Series Using Hierarchical Hidden Markov Models.” <em>Statistical Modelling</em>.</p>
</div>
<div id="ref-zuc16">
<p>Zucchini, W., I. L. MacDonald, and R. Langrock. 2016. “Hidden Markov Models for Time Series: An Introduction Using R, 2nd Edition.” <em>Chapman and Hall/CRC</em>.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>, <a href="https://timoadam.github.io/" class="external-link">Timo Adam</a>, <a href="https://ekvv.uni-bielefeld.de/pers_publ/publ/PersonDetail.jsp?personId=241029889" class="external-link">Rouven Michels</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
