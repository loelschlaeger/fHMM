<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="fHMM">
<title>Model definition • fHMM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Model definition">
<meta property="og:description" content="fHMM">
<meta property="og:image" content="https://loelschlaeger.github.io/fHMM/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">fHMM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/fHMM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v01_model_definition.html">Model definition</a>
    <a class="dropdown-item" href="../articles/v02_controls.html">Controls</a>
    <a class="dropdown-item" href="../articles/v03_data_management.html">Data management</a>
    <a class="dropdown-item" href="../articles/v04_model_estimation.html">Model estimation</a>
    <a class="dropdown-item" href="../articles/v05_state_decoding.html">State decoding</a>
    <a class="dropdown-item" href="../articles/v06_model_checking.html">Model checking</a>
    <a class="dropdown-item" href="../articles/v07_model_selection.html">Model selection</a>
    <a class="dropdown-item" href="../articles/v08_prediction.html">Prediction</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/loelschlaeger/fHMM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="v01_model_definition_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Model definition</h1>
                        <h4 data-toc-skip class="author">Lennart Oelschläger, Timo Adam and Rouven Michels</h4>
            
            <h4 data-toc-skip class="date">2022-02-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/loelschlaeger/fHMM/blob/HEAD/vignettes/v01_model_definition.Rmd" class="external-link"><code>vignettes/v01_model_definition.Rmd</code></a></small>
      <div class="d-none name"><code>v01_model_definition.Rmd</code></div>
    </div>

    
    
<!-- 
Assignee: Rouven
Purpose: definition of HMMs, definition of hierarchical structure
-->
<div class="section level2">
<h2 id="the-hidden-markov-model">The Hidden Markov Model<a class="anchor" aria-label="anchor" href="#the-hidden-markov-model"></a>
</h2>
<p>Hidden Markov models (HMMs) are a modelling framework for time series where a sequence of observation is assumed to depend on a latent state process. The peculiarity is that, instead of the observation process, the state process cannot be directly observed. However, the latent states comprise information about the environment the model is applied on. The connection between hidden state process and observed state-dependent process arises by the following:</p>
<p>Let <span class="math inline">\(N\)</span> be the number of possible states. We assume that for each point in time <span class="math inline">\(t = 1, \ldots, T\)</span>, an underlying process <span class="math inline">\((S_t)_{t = 1, \ldots, T}\)</span> selects one of those <span class="math inline">\(N\)</span> states. Then, depending on the active state <span class="math inline">\(S_t = i\)</span>, <span class="math inline">\(i = 1, \ldots, N\)</span>, the observation <span class="math inline">\(X_t\)</span> from the state-dependent process <span class="math inline">\((X_t)_{t = 1, \ldots, T}\)</span> is generated by one of the <span class="math inline">\(N\)</span> distributions <span class="math inline">\(f^{(1)},\dots,f^{(N)}.\)</span></p>
<p>Furthermore, we assume <span class="math inline">\((S_t)_t\)</span> to be Markovian, i.e. we assume that the actual state only depends on the previous state. Henceforth, we can identify the process by its initial distribution <span class="math inline">\(\delta\)</span> and its transition probability matrix (t.p.m.) <span class="math inline">\(\Gamma\)</span>. Moreover, by construction, we force the process <span class="math inline">\((X_t)_{t = 1, \ldots, T}\)</span> to satisfy the conditional independence assumption, i.e. the actual observation <span class="math inline">\(X_t\)</span> depends on the current state <span class="math inline">\(S_t\)</span>, but does not depend on previous observations or states at all.</p>
<p>Referring to financial data, the different states can serve as proxys for the actual market situation, e.g. calm or nervous. As such a mood can not directly be observed, we make use of observable data, e.g. price changes of stocks and assume that these price changes depend on the current mood. In particular, we assume price changes to be generated by different normal distribution whose mean (and in special cases its volatility) depend on the actual state <span class="math inline">\(S_t = i\)</span>.</p>
<p>Following <span class="citation">Zucchini, MacDonald, and Langrock (<a href="#ref-zuc16" role="doc-biblioref">2016</a>)</span> we also assume that the initial distribution <span class="math inline">\(\delta\)</span> equals the (assumed existing) stationary distribution <span class="math inline">\(\pi\)</span> where <span class="math inline">\(\pi = \pi \Gamma\)</span>, i.e. the stationary and henceforth the initial distribution is determined by the transition probability matrix <span class="math inline">\(\Gamma\)</span>. Doing so we reduce the number of parameters to be estimated.</p>
</div>
<div class="section level2">
<h2 id="adding-a-hierarchical-structure">Adding a Hierarchical Structure<a class="anchor" aria-label="anchor" href="#adding-a-hierarchical-structure"></a>
</h2>
<p>The structure of HMMs can easily be flexibilized. For instance, an hierarchical structure which consists of two processes observed on two different time scales can be implemented, named hierarchical hidden Markov model (HMMM). The two processes, one on a coarser and one on a finer scale differ in the number of observations, e.g. monthly observations on the coarser scale and daily or weekly observations on the finer scale. We model both time series in an hierarchical manner. In particular, we assume that the time series on the coarser scale is generated by an ordinary HMM, i.e. it adopts all the properties of the HMM displayed above.</p>
<p>Furthermore, we collect the observations of the fine-scale time series into <span class="math inline">\(T\)</span> areas such that every fine-scale observation corresponds to one according coarse-scale time point <span class="math inline">\(t = 1, \ldots, T\)</span>. Then, every chunk referring to one coarse-scale time point contains <span class="math inline">\(T^*\)</span> fine-scale observations each. This correspondence is the basis for modelling the fine-scale <span class="math inline">\(N\)</span>-state HMM with the state-dependent distributions <span class="math inline">\(f^{*(i,1)},\dots,f^{*(i,N^*)}\)</span>, the transition probability matrix <span class="math inline">\(\Gamma^{*(i)}\)</span> and the stationary distribution <span class="math inline">\(\pi^{*(i)}\)</span> (i.e., see above, equal to the initial distribution <span class="math inline">\(\delta^{*(i)}\)</span>). The hidden coarse-scale state <span class="math inline">\(S_t\)</span> determines the selection of the <span class="math inline">\(i\)</span>-th fine-scale HMM in order to explain the fine-scale observations in time chunk <span class="math inline">\(t\)</span>. In particular, for every <span class="math inline">\(t^* = 1, \ldots, T^*\)</span> the hidden fine-scale process <span class="math inline">\((S^*_{t,t^*})_{t^* = 1, \ldots, T^*}\)</span> is selecting of <span class="math inline">\(N^*\)</span> states. Then, the active state at time <span class="math inline">\(t^*\)</span> determines the selection of one distribution of the <span class="math inline">\(N^*\)</span> possible distributions <span class="math inline">\(\{f^{*(i,1)},\dots,f^{*(i,N^*)}\}\)</span>. The <span class="math inline">\(t^*\)</span>-th realization <span class="math inline">\(X^*_{t,t^*}\)</span> of the observed fine-scale state-dependent process <span class="math inline">\((X^*_{t,t^*})_{t^* = 1, \ldots, T^*}\)</span> stems from the choice of this distribution. Due to its analogous construction to regular hidden Markov frameworks, the hidden fine-scale process is Markovian and the state-dependent process fulfils the conditional independence assumption. To give the reader a better overview of the hierarchical hidden Markov model (HMM), Figure <span class="math inline">\(\color{red}{hier\ noch\ Figure\ einfügen\ falls\ erwünscht}\)</span> displays the relationship between the coarse and fine scale processes.</p>
</div>
<div class="section level2 unnumbered">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references">
<div id="ref-zuc16">
<p>Zucchini, W., I. L. MacDonald, and R. Langrock. 2016. “Hidden Markov Models for Time Series: An Introduction Using R, 2nd Edition.” <em>Chapman and Hall/CRC</em>.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>, <a href="https://timoadam.github.io/" class="external-link">Timo Adam</a>, <a href="https://ekvv.uni-bielefeld.de/pers_publ/publ/PersonDetail.jsp?personId=241029889" class="external-link">Rouven Michels</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
