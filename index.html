<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content='Fitting (hierarchical) hidden Markov models to financial data
    via maximum likelihood estimation. See Oelschläger, L. and Adam, T.
    "Detecting bearish and bullish markets in financial time series using 
    hierarchical hidden Markov models" (2021, Statistical Modelling) for a 
    reference.'>
<title>Fit hidden Markov models to financial data • fHMM</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Fit hidden Markov models to financial data">
<meta property="og:description" content='Fitting (hierarchical) hidden Markov models to financial data
    via maximum likelihood estimation. See Oelschläger, L. and Adam, T.
    "Detecting bearish and bullish markets in financial time series using 
    hierarchical hidden Markov models" (2021, Statistical Modelling) for a 
    reference.'>
<meta property="og:image" content="https://loelschlaeger.github.io/fHMM/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="index.html">fHMM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="articles/fHMM.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="articles/v01_model_definition.html">Model definition</a>
    <a class="dropdown-item" href="articles/v02_controls.html">Controls</a>
    <a class="dropdown-item" href="articles/v03_data_management.html">Data management</a>
    <a class="dropdown-item" href="articles/v04_model_estimation.html">Model estimation</a>
    <a class="dropdown-item" href="articles/v05_state_decoding_and_prediction.html">State decoding and prediction</a>
    <a class="dropdown-item" href="articles/v06_model_checking.html">Model checking</a>
    <a class="dropdown-item" href="articles/v07_model_selection.html">Model selection</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/loelschlaeger/fHMM/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="fhmm-fitting-hmms-to-financial-time-series-">{fHMM}: Fitting HMMs to financial time series <a class="anchor" aria-label="anchor" href="#fhmm-fitting-hmms-to-financial-time-series-"></a>
</h1>
</div>
<!-- badges: start -->

<p>With {fHMM} you can detect bearish and bullish markets in financial time series by applying <em>Hidden Markov Models (HMMs)</em>. The functionality and the model <a href="https://loelschlaeger.de/fHMM/articles/" class="external-link">is documented in detail here</a>. Below, you can find a first application to the German stock index <a href="https://en.wikipedia.org/wiki/DAX" class="external-link">DAX</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the released version of {fHMM} from <a href="https://CRAN.R-project.org" class="external-link">CRAN</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"fHMM"</span><span class="op">)</span></code></pre></div>
<p>And the development version from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install.packages("devtools")</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"loelschlaeger/fHMM"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="contributing">Contributing<a class="anchor" aria-label="anchor" href="#contributing"></a>
</h2>
<p>We welcome contributions! Please submit <a href="https://github.com/loelschlaeger/fHMM/issues/new?assignees=&amp;labels=bug&amp;template=bug.md" class="external-link">bug reports</a> and <a href="https://github.com/loelschlaeger/fHMM/issues/new?assignees=&amp;labels=future&amp;template=suggestion.md" class="external-link">feature requests</a> as issues and extensions as pull request from a branch created from main.</p>
</div>
<div class="section level2">
<h2 id="example-fitting-an-hmm-to-the-dax">Example: Fitting an HMM to the DAX<a class="anchor" aria-label="anchor" href="#example-fitting-an-hmm-to-the-dax"></a>
</h2>
<p>We fit a 2-state HMM with state-dependent t-distributions to the DAX log-returns from 2000 to 2020. The states can be interpreted as proxies for bearish and bullish markets.</p>
<p>The package has a build-in function to download the data from <a href="https://finance.yahoo.com/" class="external-link">Yahoo Finance</a>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>,<span class="st">"/dax.csv"</span><span class="op">)</span>
<span class="fu"><a href="reference/download_data.html">download_data</a></span><span class="op">(</span>symbol <span class="op">=</span> <span class="st">"^GDAXI"</span>, file <span class="op">=</span> <span class="va">path</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></code></pre></div>
<p>We first need to define the model by setting some <code>controls</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">controls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
  states <span class="op">=</span> <span class="fl">2</span>,
  sdds   <span class="op">=</span> <span class="st">"t"</span>,
  data   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>file        <span class="op">=</span> <span class="va">path</span>,
                date_column <span class="op">=</span> <span class="st">"Date"</span>,
                data_column <span class="op">=</span> <span class="st">"Close"</span>,
                logreturns  <span class="op">=</span> <span class="cn">TRUE</span>,
                from        <span class="op">=</span> <span class="st">"2000-01-01"</span>,
                to          <span class="op">=</span> <span class="st">"2020-12-31"</span><span class="op">)</span>
<span class="op">)</span>
<span class="va">controls</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/set_controls.html">set_controls</a></span><span class="op">(</span><span class="va">controls</span><span class="op">)</span></code></pre></div>
<p>The function <code><a href="reference/prepare_data.html">prepare_data()</a></code> prepares the data for estimation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/prepare_data.html">prepare_data</a></span><span class="op">(</span><span class="va">controls</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>
<span class="co">#&gt; Summary of fHMM empirical data</span>
<span class="co">#&gt; * number of observations: 5371 </span>
<span class="co">#&gt; * data source: dax.csv </span>
<span class="co">#&gt; * date column: Date </span>
<span class="co">#&gt; * log returns: TRUE</span></code></pre></div>
<p>We fit the model and subsequently decode the hidden states:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fit_model.html">fit_model</a></span><span class="op">(</span><span class="va">data</span>, ncluster <span class="op">=</span> <span class="fl">7</span><span class="op">)</span>
<span class="co">#&gt; Checking start values</span>
<span class="co">#&gt; Maximizing likelihood</span>
<span class="co">#&gt; Computing Hessian</span>
<span class="co">#&gt; Fitting completed</span>
<span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/decode_states.html">decode_states</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="co">#&gt; Decoded states</span>
<span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span>
<span class="co">#&gt; Summary of fHMM model</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;   simulated hierarchy       LL      AIC       BIC</span>
<span class="co">#&gt; 1     FALSE     FALSE 15920.25 -31824.5 -31771.79</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; State-dependent distributions:</span>
<span class="co">#&gt; t() </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Estimates:</span>
<span class="co">#&gt;                   lb   estimate         ub</span>
<span class="co">#&gt; Gamma_2.1  0.0113550  0.0179502  2.827e-02</span>
<span class="co">#&gt; Gamma_1.2  0.0056213  0.0089654  1.427e-02</span>
<span class="co">#&gt; mu_1       0.0005939  0.0009008  1.208e-03</span>
<span class="co">#&gt; mu_2      -0.0020763 -0.0010611 -4.585e-05</span>
<span class="co">#&gt; sigma_1    0.0073792  0.0078062  8.258e-03</span>
<span class="co">#&gt; sigma_2    0.0170391  0.0184230  1.992e-02</span>
<span class="co">#&gt; df_1       5.0194906  6.4223618  8.217e+00</span>
<span class="co">#&gt; df_2       4.9532404  6.6609735  8.957e+00</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; States:</span>
<span class="co">#&gt; decoded</span>
<span class="co">#&gt;    1    2 </span>
<span class="co">#&gt; 3645 1726</span></code></pre></div>
<p>Having estimated the model, we can visualize the state-dependent distributions and the decoded time series to interpret bearish and bullish markets:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">events</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/fHMM_events.html">fHMM_events</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>dates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2001-09-11"</span>, <span class="st">"2008-09-15"</span>, <span class="st">"2020-01-27"</span><span class="op">)</span>,
       labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"9/11 terrorist attack"</span>, <span class="st">"Bankruptcy Lehman Brothers"</span>, <span class="st">"First COVID-19 case Germany"</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, plot_type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sdds"</span>,<span class="st">"ts"</span><span class="op">)</span>, events <span class="op">=</span> <span class="va">events</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-plots-1.png" width="75%" style="display: block; margin: auto;"><img src="reference/figures/README-plots-2.png" width="75%" style="display: block; margin: auto;"></p>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=fHMM" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/loelschlaeger/fHMM/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/loelschlaeger/fHMM/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing fHMM</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-5421-9313" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://timoadam.github.io/" class="external-link">Timo Adam</a> <br><small class="roles"> Author </small>  </li>
<li>
<a href="https://ekvv.uni-bielefeld.de/pers_publ/publ/PersonDetail.jsp?personId=241029889" class="external-link">Rouven Michels</a> <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/loelschlaeger/fHMM/actions" class="external-link"><img src="https://github.com/loelschlaeger/fHMM/workflows/R-CMD-check/badge.svg" alt="R-CMD-check"></a></li>
<li><a href="https://www.r-pkg.org/badges/version-last-release/fHMM" class="external-link"><img src="https://www.r-pkg.org/badges/version-last-release/fHMM" alt="CRAN status"></a></li>
<li><a href="https://cranlogs.r-pkg.org/badges/grand-total/fHMM" class="external-link"><img src="https://cranlogs.r-pkg.org/badges/grand-total/fHMM" alt="CRAN downloads"></a></li>
<li><a href="https://app.codecov.io/gh/loelschlaeger/fHMM" class="external-link"><img src="https://codecov.io/gh/loelschlaeger/fHMM/branch/master/graph/badge.svg" alt="codecov"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://loelschlaeger.de" class="external-link">Lennart Oelschläger</a>, <a href="https://timoadam.github.io/" class="external-link">Timo Adam</a>, <a href="https://ekvv.uni-bielefeld.de/pers_publ/publ/PersonDetail.jsp?personId=241029889" class="external-link">Rouven Michels</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
